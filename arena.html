<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BattleBillions ‚Äî Dual Live Battle</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --gold:#ffd700;
      --gold-1:#ffe88a;
      --gold-2:#ffcc3b;
      --muted:#bbb;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;}
    body{
      font-family:'Orbitron', sans-serif;
      background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);
      color:white;
      overflow:hidden;
    }

    /* Streams */
    .stream-container{display:flex;height:100vh;width:100vw;position:relative;}
    .pane{flex:1;position:relative;}
    .video-stream{width:100%;height:100%;object-fit:cover;filter:brightness(.9) contrast(1.1);}

    /* HUD */
    .top-bar{
      position:absolute;top:0;left:0;right:0;display:flex;justify-content:space-between;
      padding:10px 14px;z-index:10;font-size:14px;
    }
    .hud-live{
      background:linear-gradient(180deg,var(--gold-1),var(--gold-2));
      color:#000;padding:6px 14px;border-radius:999px;font-weight:800;
      box-shadow:0 0 16px rgba(255,215,0,.4);
    }
    .hud-chip{padding:6px 14px;border-radius:999px;background:rgba(0,0,0,.4);}

    .profile-labels{
      position:absolute;top:60px;right:20px;z-index:10;
    }
    .profile-entry{display:flex;align-items:center;gap:10px;}
    .profile-entry img{width:36px;height:36px;border-radius:50%;box-shadow:0 0 8px rgba(255,215,0,.4);}
    .profile-entry span{font-weight:700;}

    /* Timer / CTA */
    .round-timer{
      position:absolute;left:50%;bottom:160px;transform:translateX(-50%);
      font-weight:800;font-size:18px;padding:12px 24px;border-radius:999px;
      background:rgba(0,0,0,.5);backdrop-filter:blur(4px);
    }
    .round-timer.animate{animation:pulse 1.8s infinite;}
    @keyframes pulse{0%,100%{transform:translateX(-50%) scale(1);}50%{transform:translateX(-50%) scale(1.08);}}

    .cta{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:20;display:none;}
    .btn{
      background:linear-gradient(180deg,var(--gold-1),var(--gold-2));
      color:#000;font-weight:800;padding:14px 28px;border-radius:12px;
      box-shadow:0 0 22px rgba(255,215,0,.4);cursor:pointer;
    }

    /* Dock (no outline box, just floating shapes) */
    .dock{
      position:absolute;left:50%;bottom:80px;transform:translateX(-50%);
      display:flex;gap:36px;z-index:20;
    }
    .shape{
      width:44px;height:44px;display:grid;place-items:center;
      cursor:pointer;transition:transform .2s ease;
    }
    .shape:hover{transform:scale(1.15);}
    .shape svg{width:100%;height:100%;stroke:#ccc;fill:none;stroke-width:2.5;}
    .primary svg{stroke:url(#goldStroke);}
    .logout svg{stroke:#ff5555;}

    /* Modal */
    .modal{position:absolute;inset:0;display:none;place-items:center;z-index:30;background:rgba(0,0,0,.6);}
    .dialog{background:#111;padding:20px;border-radius:12px;display:grid;gap:12px;}
    select{padding:8px;border-radius:6px;background:#000;color:#fff;}
  </style>
</head>
<body>
  <!-- Gradient stroke for gold -->
  <svg width="0" height="0" style="position:absolute">
    <defs>
      <linearGradient id="goldStroke" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#fff4b0"/>
        <stop offset="60%" stop-color="#ffd700"/>
        <stop offset="100%" stop-color="#ffbf2e"/>
      </linearGradient>
    </defs>
  </svg>

  <div class="stream-container">
    <div class="pane"><video class="video-stream" id="localVideo" autoplay muted playsinline></video></div>
    <div class="pane"><video class="video-stream" id="opponentVideo" autoplay muted loop src="user2.mp4"></video></div>

    <!-- HUD -->
    <div class="top-bar">
      <span class="hud-live">LIVE</span>
      <span class="hud-chip">üëÅ 1.3k</span>
    </div>
    <div class="profile-labels"><div class="profile-entry"><img id="opponentImage" src="user2.jpg"><span id="opponentUsername">@Opponent</span></div></div>

    <!-- Timer + CTA -->
    <div class="round-timer" id="roundTimer">Select your instrumental‚Ä¶</div>
    <div class="cta"><button id="startBattleBtn" class="btn">üî• Start Battle</button></div>

    <!-- Dock: only shapes -->
    <nav class="dock">
      <div class="shape"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="9"/></svg></div>
      <div class="shape"><svg viewBox="0 0 24 24"><rect x="6" y="6" width="12" height="12"/></svg></div>
      <div class="shape primary"><svg viewBox="0 0 24 24"><polygon points="12,5 20,19 4,19"/></svg></div>
      <div class="shape"><svg viewBox="0 0 24 24"><polygon points="12,4 20,12 12,20 4,12"/></svg></div>
      <div class="shape logout"><svg viewBox="0 0 24 24"><line x1="6" y1="6" x2="18" y2="18"/><line x1="18" y1="6" x2="6" y2="18"/></svg></div>
    </nav>

    <!-- Modal -->
    <div class="modal" id="instModal">
      <div class="dialog">
        <h3>Select Instrumental</h3>
        <select id="instrumentalSelect">
          <option disabled selected value="">Choose a beat</option>
          <option value="beat1.mp3">üî• Classic Trap</option>
          <option value="beat2.mp3">üí• Boom Bap</option>
          <option value="beat3.mp3">üåä Chill Vibes</option>
        </select>
        <button class="btn" id="confirmInst">Confirm</button>
      </div>
    </div>
  </div>

  <audio id="battleTrack" hidden></audio>
  <audio id="roundEndSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_38ca955dae.mp3?filename=click-124467.mp3"></audio>

  <script>
    const localVideo=document.getElementById('localVideo');
    const opponentVideo=document.getElementById('opponentVideo');
    const opponentImage=document.getElementById('opponentImage');
    const opponentUsername=document.getElementById('opponentUsername');
    const instModal=document.getElementById('instModal');
    const selectInst=document.getElementById('instrumentalSelect');
    const confirmInst=document.getElementById('confirmInst');
    const startBtn=document.getElementById('startBattleBtn');
    const startBtnWrap=document.querySelector('.cta');
    const timerEl=document.getElementById('roundTimer');
    const battleTrack=document.getElementById('battleTrack');
    const endSound=document.getElementById('roundEndSound');

    const opponents=[{video:"user2.mp4",image:"user2.jpg",username:"@OpponentA"},
                     {video:"user3.mp4",image:"user3.jpg",username:"@ChallengerX"},
                     {video:"user4.mp4",image:"user4.jpg",username:"@MCNeo"}];

    async function startCamera(){
      try{
        const stream=await navigator.mediaDevices.getUserMedia({video:true,audio:true});
        localVideo.srcObject=stream;
      }catch(e){console.warn(e);}
    }

    confirmInst.onclick=()=>{
      const src=selectInst.value;
      if(!src){alert("Pick a beat.");return;}
      battleTrack.src=src;battleTrack.load();
      instModal.style.display='none';
      startBtnWrap.style.display='block';
      timerEl.textContent="Press Start Battle to begin";
    };

    let state={round:1,part:0,time:33,tick:null};
    function setTimer(){timerEl.textContent=`Round ${state.round}/3 | ${state.part===0?'@You':'@Opponent'} | ${state.time}s`;}
    function tick(){
      state.tick=setInterval(()=>{
        setTimer();state.time--;
        if(state.time<0){
          clearInterval(state.tick);endSound.play();
          if(state.part===0){state.part=1;state.time=33;timerEl.textContent="Switching...";setTimeout(startRound,1000);}
          else if(state.round<3){state.round++;state.part=0;state.time=33;timerEl.textContent="Next Round...";setTimeout(startRound,1000);}
          else{timerEl.textContent="üî• Battle Over üî•";setTimeout(newOpponent,2000);}
        }
      },1000);
    }
    function startRound(){tick();}
    function newOpponent(){
      const next=opponents[Math.floor(Math.random()*opponents.length)];
      opponentVideo.src=next.video;opponentImage.src=next.image;opponentUsername.textContent=next.username;
      state={round:1,part:0,time:33,tick:null};startBtnWrap.style.display='block';timerEl.textContent="üî• New Opponent Ready üî•";
    }

    startBtn.onclick=()=>{
      startBtnWrap.style.display='none';
      battleTrack.play();
      timerEl.classList.add('animate');
      startRound();
    };

    window.onload=()=>{startCamera();instModal.style.display='grid';};
  </script>
</body>
</html>
