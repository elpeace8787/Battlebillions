<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Ad Arena — Side-by-Side Vertical</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&family=Orbitron:wght@600;800&display=swap" rel="stylesheet"/>
<style>
  :root{
    --bg:#0c0c0f; --ink:#f6f7fb; --muted:#a7adb9; --glass:rgba(255,255,255,.07); --bd:#ffffff24; --dim:rgba(0,0,0,.5);
    --vh:100svh;            /* JS keeps real mobile height */
    --topH:56px; --botH:58px;/* measured at runtime */
    --arenaH:calc(var(--vh) - var(--topH) - var(--botH));
    --paneH:360px;          /* JS sets this so both panels fit across */
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}

  /* Header / Footer (sticky so page can scroll) */
  header.topbar{
    position:sticky;top:0;z-index:40;display:flex;align-items:center;gap:.6rem;flex-wrap:wrap;
    padding:.7rem .9rem;background:rgba(16,16,18,.9);backdrop-filter:blur(10px);border-bottom:1px solid var(--bd)
  }
  .logo{font-family:Orbitron,Inter,sans-serif;font-weight:800;letter-spacing:.5px}
  .spacer{flex:1}
  .btn{border:1px solid var(--bd);background:#ffffff14;color:var(--ink);border-radius:12px;padding:.56rem .9rem;font-weight:800}
  .btn.gold{background:linear-gradient(180deg,#ffe88a,#ffc400);border:none;color:#121212}
  .chip{display:inline-flex;align-items:center;gap:.45rem;background:var(--glass);border:1px solid var(--bd);border-radius:999px;padding:.38rem .6rem;font-weight:800}

  footer.bottomnav{
    position:sticky;bottom:0;z-index:40;display:flex;align-items:center;justify-content:space-around;
    height:calc(58px + env(safe-area-inset-bottom));padding:.3rem .6rem calc(.3rem + env(safe-area-inset-bottom));
    border-top:1px solid var(--bd);background:rgba(16,16,18,.95);backdrop-filter:blur(10px)
  }
  .navbtn{display:flex;flex-direction:column;align-items:center;gap:.2rem;text-decoration:none;color:var(--ink)}
  .navbtn svg{width:22px;height:22px}.navlbl{font-size:.72rem}

  /* ===== Arena: two vertical panels, side-by-side, touching ===== */
  .arenaWrap{padding:0}
  .panes{
    height:var(--arenaH);
    display:grid;grid-template-columns:1fr 1fr;gap:0; /* touching */
    position:relative
  }
  /* thin divider (visual only, panels still touch) */
  .panes::before{
    content:"";position:absolute;left:50%;top:0;bottom:0;width:1px;background:linear-gradient(180deg,transparent,#ffffff20,transparent);
    transform:translateX(-.5px)
  }
  .pane{
    position:relative; height:var(--paneH); /* JS computes so both fit across */
    display:grid;place-items:center;overflow:hidden;background:#000
  }
  .stage{position:absolute;inset:0;display:grid;place-items:center}
  .phone{width:100%;height:100%;display:grid;place-items:center}
  /* The frame is true 9:16 and fills the pane height; width scales automatically */
  .frame{position:relative;aspect-ratio:9/16;height:100%;width:auto;border-radius:0;overflow:hidden;background:#000}
  video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
  /* remove any inner radius so panels look like two phones touching */
  #paneA .frame{border-right:0}
  #paneB .frame{border-left:0}
  .shade{position:absolute;inset:0;background:transparent;transition:background .25s}
  .pane.dim .shade{background:var(--dim)}

  /* HUD & inline controls (unchanged from your last version) */
  .hud{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:space-between;pointer-events:none}
  .toprow{display:flex;justify-content:space-between;align-items:center;padding:.55rem .65rem}
  .center-top{position:absolute;left:50%;transform:translateX(-50%);top:.55rem;display:flex;gap:.45rem;align-items:center}
  .iconbtn{pointer-events:auto;display:grid;place-items:center;width:42px;height:42px;border-radius:999px;background:var(--glass);border:1px solid var(--bd)}
  .iconbtn svg{width:20px;height:20px}
  .votes{position:absolute;top:2.7rem;right:.65rem;background:var(--glass);border:1px solid var(--bd);padding:.28rem .55rem;border-radius:999px;font-weight:800}
  .inline-controls{position:absolute;left:50%;transform:translateX(-50%);bottom:.7rem;display:flex;gap:.55rem;z-index:3}
  .minibtn{pointer-events:auto;border:1px solid var(--bd);background:#ffffff12;color:var(--ink);border-radius:12px;padding:.42rem .62rem;font-weight:800}
  .minibtn.gold{background:linear-gradient(180deg,#ffe88a,#ffc400);border:none;color:#121212}
  .hint{position:absolute;left:50%;bottom:50%;transform:translate(-50%,50%);background:var(--glass);border:1px solid var(--bd);padding:.34rem .56rem;border-radius:10px;font-size:.86rem;opacity:.95}

  /* Full-screen chooser & composer carry over (styles omitted for brevity) */
</style>
</head>
<body>
  <!-- ===== Header ===== -->
  <header class="topbar" id="topBar">
    <div class="logo">AD ARENA</div>
    <div id="chips" class="row" style="display:none;gap:.5rem">
      <div class="chip" id="chipCat"></div>
      <div class="chip" id="chipSub"></div>
    </div>
    <div class="spacer"></div>
    <button class="btn gold" id="chooseBtn">Choose Category</button>
    <button class="btn" id="createBtn">Edit Ad</button>
  </header>

  <!-- ===== Arena (side-by-side vertical screens) ===== -->
  <main class="arenaWrap">
    <section class="panes" id="panes">
      <!-- Panel A -->
      <article class="pane" id="paneA">
        <div class="stage"><div class="phone"><div class="frame" id="frameA"><video id="vidA" playsinline muted></video></div></div></div>
        <div class="shade"></div>
        <div class="hud">
          <div class="toprow">
            <button class="iconbtn" id="exitBtn" title="Exit">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="2" d="M6 6l12 12M18 6L6 18"/></svg>
            </button>
            <div class="center-top">
              <div class="chip" id="roundsChip">R1 / 3</div>
              <div class="chip" id="timerChip">00:30</div>
            </div>
            <button class="iconbtn" id="flagBtn" title="Flag">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="2" d="M4 4v16M4 4h11l-1.5 3H20l-2 4 2 4h-4l-1.5-3H4"/></svg>
            </button>
          </div>
          <div class="votes" id="votesA">0</div>
          <div class="hint" id="hint">Tap a panel to vote</div>
        </div>
        <div class="inline-controls">
          <button class="minibtn" id="composeA">Edit Ad</button>
          <a class="minibtn" id="ctaA" href="#" target="_blank" rel="noopener">CTA</a>
          <div class="chip">
            <label style="opacity:.8;margin-right:.35rem">Rounds</label>
            <select id="roundsSel"><option>1</option><option selected>3</option><option>5</option></select>
            <label style="opacity:.8;margin-left:.45rem;margin-right:.35rem">Turn</label>
            <select id="turnSel"><option>15</option><option selected>30</option><option>45</option><option>60</option></select>
            <button class="minibtn gold" id="startBtn">Start</button>
          </div>
        </div>
        <div id="tapA" style="position:absolute;inset:0"></div>
      </article>

      <!-- Panel B -->
      <article class="pane" id="paneB">
        <div class="stage"><div class="phone"><div class="frame" id="frameB"><video id="vidB" playsinline muted></video></div></div></div>
        <div class="shade"></div>
        <div class="hud">
          <div class="toprow" aria-hidden="true"></div>
          <div class="votes" id="votesB">0</div>
        </div>
        <div class="inline-controls">
          <button class="minibtn" id="composeB">Edit Ad</button>
          <a class="minibtn" id="ctaB" href="#" target="_blank" rel="noopener">CTA</a>
        </div>
        <div id="tapB" style="position:absolute;inset:0"></div>
      </article>
    </section>
  </main>

  <!-- ===== Footer ===== -->
  <footer class="bottomnav" id="bottomNav">
    <a class="navbtn" href="#"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="2" d="M3 11l9-8 9 8v9"/></svg><span class="navlbl">Home</span></a>
    <a class="navbtn" href="#"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="11" cy="11" r="7" stroke-width="2"/><path d="M21 21l-4.3-4.3" stroke-width="2"/></svg><span class="navlbl">Discover</span></a>
    <a class="navbtn" href="#"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="5" y="4" width="14" height="7" rx="1.5" stroke-width="2"/><rect x="5" y="13" width="14" height="7" rx="1.5" stroke-width="2"/></svg><span class="navlbl">Ad Arena</span></a>
    <a class="navbtn" href="#"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-width="2" d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><path stroke-width="2" d="M7 10l5 5 5-5"/></svg><span class="navlbl">Inbox</span></a>
    <a class="navbtn" href="#"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="7" r="4" stroke-width="2"/><path stroke-width="2" d="M5.5 21a6.5 6.5 0 0 1 13 0"/></svg><span class="navlbl">Profile</span></a>
  </footer>

  <!-- ===== Category chooser & Edit Ad composer (reuse from your last file) ===== -->
  <!-- Keep your chooser/composer markup here unchanged -->
  <!-- … -->

<script>
  const $ = s => document.querySelector(s);

  /* ===== Real mobile viewport + measured bars ===== */
  function setViewportVars(){
    const vv = window.visualViewport;
    const vh = Math.round(vv?.height || window.innerHeight);
    document.documentElement.style.setProperty('--vh', vh+'px');

    // measure sticky bars
    const top = Math.round($('#topBar').getBoundingClientRect().height);
    const bot = Math.round($('#bottomNav').getBoundingClientRect().height);
    document.documentElement.style.setProperty('--topH', top+'px');
    document.documentElement.style.setProperty('--botH', bot+'px');

    // compute pane height so TWO 9:16 frames fit across the screen width
    const w = Math.round(window.innerWidth);
    const halfW = w/2;                  // each panel gets half the width
    const heightFromWidth = halfW * (16/9); // 9:16 => h = w * 16/9
    const maxArenaH = vh - top - bot;   // don't exceed visible viewport
    const paneH = Math.min(heightFromWidth, maxArenaH);
    document.documentElement.style.setProperty('--arenaH', maxArenaH+'px');
    document.documentElement.style.setProperty('--paneH', Math.floor(paneH)+'px');
  }
  ['load','resize','orientationchange'].forEach(ev=>addEventListener(ev, setViewportVars, {passive:true}));
  setViewportVars();

  /* ===== Keep your existing JS (chooser, composer, battle engine) ===== */
  // If you're pasting into your previous file, keep all logic below this line.
  // For brevity, not repeating the full composer/chooser code here — it works unchanged.

  // Minimal stubs so this snippet runs standalone:
  const vidA=$('#vidA'), vidB=$('#vidB'); const audA=new Audio(), audB=new Audio();
  const roundsSel=document.createElement('select'), turnSel=document.createElement('select');
  const roundsChip=$('#roundsChip'), timerChip=$('#timerChip'), votesA=$('#votesA'), votesB=$('#votesB'), hint=$('#hint');
  let roundsTotal=3, roundNow=1, turnSecs=30, tLeft=30, current='A', ticker=null;
  function mmss(s){const m=String(Math.floor(s/60)).padStart(2,'0');const ss=String(Math.floor(s%60)).padStart(2,'0');return `${m}:${ss}`;}
</script>
</body>
</html>
